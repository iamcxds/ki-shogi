# 麒将棋 Ki Shogi

A terminal-based implementation of Ki Shogi, a two-player strategy game played on an infinite board with dice-shaped pieces. Designed by L.Lynn Smith.

> **Vibe Coding Experiment** — Every line of code in this project was generated by AI (Claude). No code was hand-written. The human provided game rules, design direction, and iterative feedback; the AI wrote all implementation.

![Node.js](https://img.shields.io/badge/Node.js-%3E%3D12-green)

## How to Play

```bash
node main.js
```

No dependencies required — just Node.js.

## Game Overview

Each player controls dice-shaped pieces (cubes) where each face represents a different unit with unique movement. The board is infinite — pieces can move in any direction without boundary.

**Piece Sets:**
- Basic: 玉 (King) + 飛 (Rook die) + 角 (Bishop die)
- Full: adds 麒 (Kirin die)

Each die has 6 faces with different movement patterns. The current face determines how the piece moves.

## Core Rules

**Setup:** Both players place their 玉 (King). The two Kings must be exactly Chebyshev distance 2 apart. Remaining pieces start in hand.

**Movement:** Move a piece according to its current face's pattern. Non-capture moves automatically flip the die to the opposite face.

**Capture:** Move onto an opponent's piece to capture it. After capturing, choose a promotion face instead of flipping. The captured piece goes to your hand.

**Dropping:** Press `D` to drop a hand piece onto the board. Choose which face to show, then place it adjacent to your King (or within distance 2 for 麒 cubes). Drops cannot give check.

**Support Rule:** Pieces must be supported — adjacent to your King or a 麒 cube. 麒 cubes can be within distance 2 of your King or adjacent to another 麒. Unsupported pieces at end of turn are captured by the opponent.

**Win Condition:** Capture the opponent's 玉, or leave them with no legal action.

**Sennichite (千日手):** If the same position repeats 4 times, the game is a draw. If one player was giving check every repetition, that player loses (perpetual check).

## Controls

| Key | Action |
|-----|--------|
| Arrow keys | Move cursor |
| Enter | Select / Confirm |
| ESC | Cancel / Back |
| D | Drop a hand piece |
| Tab | Browse move log |
| Space | Pause/Resume (AI mode) |
| R | Restart with same settings |
| L | Toggle language (中文/English) |
| M | Return to main menu |
| Q | Quit |

## Game Modes

- **Local 2P** — Two players on the same terminal
- **AI Battle** — Play against AI (Easy / Normal / Hard)
- **AI vs AI** — Watch two AIs play each other (pauseable)
- **Tutorial** — In-game rule guide (7 pages)

## AI Difficulty

| Level | Strategy |
|-------|----------|
| Easy | Random moves (avoids perpetual check loss) |
| Normal | Prioritizes captures, checks, and board control |
| Hard | Minimax search with alpha-beta pruning |

All AI levels are aware of sennichite and avoid repetition draws.

## Display

- **White/Bold** = Black player (先手, moves first)
- **Cyan** = White player (後手, moves second)
- **Yellow highlight** = Cursor / move origin in log
- **Blue highlight** = Selected piece / move destination in log
- **Green highlight** = Legal move targets / drop positions

Move hints with diagrams appear on the right side of the board, showing the selected piece's movement pattern, flip face, and promotion options.

## Project Structure

```
ki-shogi/
├── main.js     # Game loop, input handling, AI engine
├── types.js    # Constants, piece data, movement definitions
├── state.js    # Piece class, GameState class, UI modes
├── rules.js    # Legal moves, drops, check detection, support rules
├── render.js   # ANSI terminal renderer with sidebar hints
├── input.js    # Raw stdin keyboard handler
└── lang.js     # i18n (Chinese/English) + tutorial content
```

## License

This is an implementation of Ki Shogi, a game designed by L.Lynn Smith.
